{
  "hash": "ea787e0bc60a37a4e06388349f846296",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Histograms in **R** with `ggplot2`\nsubtitle: Cheatsheet\ndate: today\nlightbox: true\n---\n\n\n\n\n\n::: {.callout-note appearance=\"simple\"}\nThis work was developed using resources that are available under a [Creative Commons Attribution 4.0 International License](https://creativecommons.org/licenses/by/4.0/), made available on the [SOLES Open Educational Resources](https://github.com/usyd-soles-edu) repository by the School of Life and Environmental Sciences, The University of Sydney.\n:::\n\n-----\n\n::: {.content-visible unless-format=\"pdf\"}\n::: {layout-ncol=3}\n![](assets/histo_p1.svg)\n\n![](assets/histo_p3.svg)\n\n![](assets/histo_p4.svg)\n:::\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n![](assets/histo_p1.png)\n\n![](assets/histo_p3.png)\n\n![](assets/histo_p4.png)\n:::\n\n## About\nThe histogram is a bar plot that shows the frequency of (often) continuous values in a dataset. It helps identify patterns, outliers, and the shape of the distribution (skewness, kurtosis). \n\n::: {.callout-note collapse=\"true\"}\n## Assumed knowledge\n- You know how to install and load packages in R.\n- You know how to import data into R.\n- You recognise data frames and vectors.\n:::\n\n::: {.callout-important collapse=\"true\"}\n## Data structure\nThe data should be in a **long format** (also known as tidy data), where each row is an observation and each column is a variable (@fig-format). If your data is not already structured this way, reshape it manually in a spreadsheet program or in R using the `pivot_longer()` function from the `tidyr` package.\n\n\n::: {layout=\"[ 0.4, -0.1, 0.4 ]\" #fig-format}\n\n:::: {#first-column}\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\\begin{longtable}{lr}\n\\toprule\nSex & BW \\\\ \n\\midrule\\addlinespace[2.5pt]\nF & 2.15 \\\\ \nM & 2.55 \\\\ \nF & 2.95 \\\\ \nF & 2.70 \\\\ \nM & 2.20 \\\\ \nF & 1.85 \\\\ \nM & 2.55 \\\\ \nM & 2.60 \\\\ \n\\bottomrule\n\\end{longtable}\n\n:::\n:::\n\n\n\n:::\n\n::: {#second-column}\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\\begin{longtable}{rr}\n\\toprule\nF & M \\\\ \n\\midrule\\addlinespace[2.5pt]\n2.15 & 2.55 \\\\ \n2.95 & 2.20 \\\\ \n2.70 & 2.55 \\\\ \n1.85 & 2.60 \\\\ \n\\bottomrule\n\\end{longtable}\n\n:::\n:::\n\n\n\n:::\n\nData should be in long format (left) where each row is an observation and each column is a variable. This is the preferred format for most statistical software. Wide format (right) is also common, but may require additional steps to analyse or visualise in some instances.\n::::\n:::\n\n## Data\nFor this cheatsheet we will use the entire possums dataset used in [BIOL2022](https://www.sydney.edu.au/units/BIOL2022) labs.\n\n\n\n\n{{< downloadthis possums.xlsx dname=\"possum\" label=\"Download the possums data\" type=\"primary\" >}}\n\n\n\n\n\n\n## Import data\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readxl)\npossums <- read_excel(\"possums.xlsx\", sheet = 2)\n```\n:::\n\n\n\n\n\n## Plot\n\nUse the different plots below to explore the use of histograms in R. Note that histograms only need one variable to be plotted, therefore we pick any one of the several continuous variables in the dataset in the `aes()` function.\n\n::: panel-tabset\n## Version 1\nThere bare minimum code to create a histogram in R.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2) # <1>\nggplot(possums, aes(x = BW)) + # <2>\n  geom_histogram() # <3>\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](histogram_r_files/figure-pdf/unnamed-chunk-5-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n1. Load the `ggplot2` package with `library(ggplot2)`.\n2. Create a canvas using `ggplot()` and specify the variable to be plotted on the x-axis with `aes(x = BW)`.\n3. Add a histogram layer using `geom_histogram()`.\n\n\n\n\n\n\n\n\n\n## Version 2\nAdd colours, labels, adjust bin width, and change the theme.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nggplot(possums, aes(x = BW)) +\n  geom_histogram(fill = \"skyblue\", color = \"black\", # <1>\n                 binwidth = .3) + # <2>\n  labs(x = \"Body weight (g)\", # <3>\n       y = \"Frequency\") +\n  theme_minimal() # <4>\n```\n\n::: {.cell-output-display}\n![](histogram_r_files/figure-pdf/unnamed-chunk-7-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n1. Use `colour` and `fill` arguments to change bar colors.\n2. Adjust bin width with `binwidth` to control the detail of the histogram. A smaller value will increase the number of bars based on the range of the data.\n3. Add axis labels using `labs()`.\n4. Use `theme_minimal()` for a standardized appearance.\n\n\n\n\n\n\n\n\n## Version 3\nPlot both a histogram and a density plot at the same time.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\np3 <- ggplot(possums, aes(x = AactiveTBLUP, \n                    y = after_stat(density))) +\n  geom_histogram(\n    fill = \"white\", \n    color = \"black\", \n    position = \"identity\",\n    binwidth = 0.3) +\n  geom_density(position = \"identity\", fill = \"red\", alpha = 0.5) +\n  theme_bw()\n\np3\n```\n\n::: {.cell-output-display}\n![](histogram_r_files/figure-pdf/unnamed-chunk-9-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n\n\n\n\n\n## Version 4\nCompare a histogram with a standardised normal distribution.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nggplot(possums, aes(x = AactiveTBLUP)) +\n  geom_histogram(aes(y = after_stat(density)), \n                 fill = \"skyblue\", \n                 color = \"black\", \n                 binwidth = 0.3) +\n  stat_function(fun = dnorm, \n                args = list(mean = mean(possums$AactiveTBLUP), \n                            sd = sd(possums$AactiveTBLUP)), \n                color = \"red\", linewidth = 1) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](histogram_r_files/figure-pdf/unnamed-chunk-11-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n\n\n:::\n\n## Export\n\nUse the `ggsave()` function to save the plot as an image file. \n\n- The `filename` argument specifies the name of the file.\n- The `plot` argument specifies the plot to be saved. In this case, the plot is stored in the object `p3` (from Version 3).\n- The `width` and `height` arguments specify the dimensions of the plot in inches.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggsave(filename = \"histogram.pdf\", plot = p3, width = 7, height = 5)\n```\n:::\n\n\n\n\nThe plot will be saved in the working directory, unless you specify a different path in the `filename` argument.\n\n",
    "supporting": [
      "histogram_r_files/figure-pdf"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "\\usepackage{booktabs}\n\\usepackage{caption}\n\\usepackage{longtable}\n\\usepackage{colortbl}\n\\usepackage{array}\n"
      ]
    },
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}